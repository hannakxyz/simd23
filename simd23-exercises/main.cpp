/*
main.cpp - Entry point for the SIMD exercises!
Author: hanna
Created: 2023-10-04

*/

#define HANNA_ENABLE_ASSERTS 1
#include "shared/hanna_util.h"
#include <algorithm>

//
// NOTE: Debug helpers
//

static void dump_256epi32(const char *name, __m256i v){
  I32 e[8];
  _mm256_storeu_si256((__m256i*)e, v);

  printf("%20s: ", name);
  fiz(8){
    printf("%5i, ", e[i]);
  }
  printf("\n");
}

static void dump_128epi32(const char *name, __m128i v){
  I32 e[4];
  _mm_storeu_si128((__m128i*)e, v);

  printf("%20s: ", name);
  fiz(4){
    printf("%5i, ", e[i]);
  }
  printf("\n");
}

//
// NOTE: INCLUDE EXERCISES
//

//#define EXERCISE_FN __attribute__((noinline)) static
#define EXERCISE_FN static

#include "exercise1.cpp"
#include "exercise2.cpp"
#include "exercise3.cpp"
#include "exercise4.cpp"

static void dump_f32(F32 *f32, U32 count){
  fiz(count){
    printf("%.9e,", f32[i]);
  }
  printf("\n");
}

static void dump_i32(I32 *i32, U32 count){
  fiz(count){
    printf("%5i,", i32[i]);
  }
  printf("\n");
}


//
// EXERCISE 1 WRAPPERS (YES, THIS IS DONE IN A REALLY STUPID WAY BUT IT IS JUST A STUPID EXERCISE.)
//

#define E1_INPUT_COUNT 256
F32 e1_input_x0[E1_INPUT_COUNT] = { 7.825944424,1.675734520,0.832520604,1.175970554,1.427802086,5.168294907,7.600400925,4.451709747,4.273128986,8.096529007,6.779489517,8.968882561,0.440398097,2.079128504,4.200558186,2.008268356,5.913102627,5.328557491,3.182794809,6.835792065,3.059720039,5.661357880,0.850370228,1.889790177,6.382620811,7.360427856,4.670542717,2.134890795,2.472498894,7.931284428,0.609118462,3.648043633,1.185496569,5.593510151,6.257299423,7.449393272,6.446943760,6.442352295,5.022784233,4.738033295,8.984664917,5.534979820,0.328730106,2.485639811,6.900427341,9.041411400,5.625994205,5.574477196,5.339614868,8.995759964,0.745681465,9.822362900,7.163549423,7.848212242,3.528972864,7.401671410,8.547256470,9.184664726,2.157241344,5.173653603,7.411653519,7.675058365,5.499789715,2.100301027,1.491391659,5.848345757,2.130375624,2.012216806,3.240418673,0.654241800,4.392979622,3.789399624,1.731588721,1.998904943,6.171658516,5.527794361,1.100075960,2.184911013,2.742571592,0.874420702,1.676987290,1.137675524,3.708295822,1.851294279,6.763095856,1.188730240,7.001592636,2.965126276,6.252234459,7.540471077,9.266661644,1.557080984,7.330081940,4.800862312,8.630506516,7.554400444,5.424571037,7.238452435,6.163556576,3.153054714,2.485577822,0.074974544,3.072622061,7.260996819,9.234974861,6.995800018,8.686758041,5.388788700,9.893611908,8.548272133,4.308444500,1.404482722,7.690579891,2.410331726,6.286504745,7.353457451,6.221206665,1.505956888,3.181252718,1.433926940,1.288814545,6.182051182,0.049315412,9.191902161,0.507720172,7.493832111,9.749485970,0.402224690,9.350946426,1.898044109,5.062668324,3.219840527,5.017051220,2.230608702,0.290426493,7.547444820,5.840504646,8.371559143,7.556844711,3.977895975,7.942405224,8.475643158,5.872929573,2.924729824,0.483757138,8.562637329,3.167565346,0.419830829,7.336989403,3.405520439,9.303625107,6.728913307,5.874095440,7.725039482,2.302158117,7.163065910,9.572998047,1.308950067,6.806801796,0.472300202,7.822819233,3.596298933,4.404870033,1.324672580,4.571461201,0.938120425,0.996888876,7.125758648,9.556164742,3.779653311,1.097063899,4.878427505,8.738642693,7.139493942,9.441338539,3.697462559,0.996002913,4.949808598,8.744473457,2.045257330,8.158469200,1.340856433,1.200463772,0.511605263,3.909841061,7.876591682,4.181470394,0.316895813,8.415717125,7.346519947,9.833017349,3.711923122,2.125727654,1.868464708,1.480804920,2.019471645,3.669345856,3.192977905,4.063853264,2.310314417,6.380650520,1.840398192,1.306853175,9.185050964,6.196709156,2.322723150,5.571879387,1.625356555,3.221942186,2.236892939,3.985250235,6.200572968,8.312328339,0.520405650,4.197935581,7.097975731,0.089451402,9.136353493,7.938847542,7.525783539,3.419266939,2.988196611,5.112042904,5.678982258,3.740083933,8.430962563,2.662245750,2.620885611,8.908467293,4.002771854,8.471203804,2.034167290,2.493211985,9.710720062,1.149536014,5.044692039,0.474523485,3.096080780,0.448236465,9.039877892,0.657493234,3.399358988,0.419217825,3.278614998,2.677500248,0.606150091,4.081001759,1.365836740,9.991667747,6.923520088,5.098307610,6.669308662,8.253651619,2.953453064,2.921761274,9.997293472, };
F32 e1_input_y0[E1_INPUT_COUNT] = { 6.059879780,4.293392658,2.952890635,5.331110477,1.069347620,2.005660057,2.354825735,6.500515461,1.958197594,8.148099899,3.004410744,5.257165432,9.169286728,8.728579521,1.601882696,2.078058243,2.342109919,1.828776836,6.069717884,2.947640896,9.118021011,5.968504906,2.354162693,0.389825672,9.144042969,4.638545990,5.432019711,8.049286842,1.319510818,3.241034508,0.575750470,1.416625023,1.636290431,1.959765196,8.204835892,4.402441025,4.914076328,5.850271702,4.612670422,1.236649990,2.030278206,1.526721120,7.116637230,3.369205475,1.423436284,6.875263214,9.138280869,7.135999680,4.300051212,3.906915665,6.002204895,1.681205273,9.699414253,9.998145103,0.181043074,9.706962585,9.520565987,4.048914909,9.894772530,1.125974178,2.296558857,2.082910776,7.901187897,7.380587578,4.287217140,2.588366508,0.807012200,7.679810047,0.266613990,7.243613720,1.091916680,3.032626867,2.634622574,5.998268604,7.216239452,5.085937977,0.941449404,4.459770679,0.518432796,4.015838146,5.951980591,5.986591339,1.045017958,8.491876602,0.896672904,1.392041564,0.842119396,8.841468811,7.014138699,8.043263435,8.282833099,4.606755257,8.222785950,5.940690041,3.579556704,9.928186417,7.151705742,7.390685081,3.588773727,8.762941360,4.558868885,4.453778267,2.083251476,3.547812939,8.399385452,4.911808968,8.289380074,8.608253479,9.341835022,7.750205517,5.954580784,7.715838432,4.741907120,4.049405098,3.248311043,0.081657603,1.294224739,2.950676918,3.880921841,5.733357430,2.485546827,2.461285830,7.308907509,1.404097557,9.242117882,6.066983223,1.647446275,3.240879059,1.845686316,3.913813829,1.908253193,6.382750511,9.350017548,6.721149445,1.122588158,8.806926727,6.795557022,6.703841209,9.489646912,1.251715422,4.785180569,8.843790054,7.256643772,2.171719074,6.591854095,4.411433220,5.655021667,7.940222740,4.674269199,1.888164401,2.496708632,7.902943611,1.771272421,2.855307102,5.123329163,6.491904259,4.485986710,5.965790749,9.614491463,3.588979244,1.698282242,2.049115658,9.979914665,7.466492653,8.630386353,7.893200397,9.058714867,8.681751251,1.010113358,7.280412674,0.358303636,0.652723253,0.611676097,8.633892059,4.098333359,8.868943214,1.627300024,4.332194328,1.166815639,7.715591908,0.679281831,2.861430883,3.890981674,9.325286865,5.639379025,1.551493526,1.166894674,7.127475262,6.857965469,9.062602997,0.537543476,0.215397447,2.229993105,3.529019594,6.819209099,7.548923492,8.675429344,2.769253016,3.143882990,6.745979786,1.942224622,0.065621376,3.580515146,2.510679960,4.316466331,5.043482304,0.957398713,3.416417837,1.243609667,1.204475760,6.792392731,3.301254272,3.536918163,5.617468834,8.589064598,1.330427051,4.958523750,7.770801544,1.802812576,1.511529922,6.060500622,5.108370781,0.439761162,8.429156303,6.898402691,8.483309746,1.393246412,2.340220690,3.612844944,9.550174713,4.750268936,9.287768364,7.730238914,6.636909485,0.963531375,0.900276899,5.684055328,8.762412071,2.200711966,7.503037453,9.092387199,8.781599045,3.798669338,0.509024441,8.207448959,7.097911358,3.972388506,8.003505707,9.199539185,6.316444874,4.020659924,2.397698879,4.345533848,6.353268623,7.009652138,7.976638794, };
F32 e1_input_z0[E1_INPUT_COUNT] = { 8.230401039,2.045941591,1.353870869,2.784623861,8.049327850,5.412774086,2.724774837,7.056905746,4.128293514,2.185843468,6.897774696,6.145352364,4.464900970,8.618638992,1.855809212,8.644904137,7.428042412,2.954399586,0.170103639,9.885741234,4.044714928,7.084360600,8.289830208,1.297048569,2.432980299,6.938972473,1.326468229,3.104571342,6.515237808,1.629152060,9.331583977,1.094090223,9.200162888,6.663675308,7.096227646,0.842668533,3.010665894,3.741838694,6.333609581,3.166354895,8.279943466,7.349267483,1.977325082,6.276407242,4.296304703,0.931663632,4.618001938,0.389771312,2.319410086,9.623914719,9.183196068,1.035414815,4.342948437,5.978863716,8.552035332,0.829099357,3.955448627,0.662118137,9.269239426,7.078022480,2.522722244,0.221663281,3.831607103,5.266306400,1.126466274,5.655167103,8.797201157,7.903802872,4.304379463,2.544119596,3.409503698,2.839092016,4.415535927,4.192127705,1.725074768,6.725868225,6.666428566,6.134070396,3.729019165,3.461820602,6.223276138,9.056947708,3.259025097,6.833124638,5.757477283,9.202006340,3.703603745,3.881488085,8.374070168,8.508449554,8.176620483,8.082962990,5.558726788,5.641639709,3.227463722,5.363862991,4.477567196,1.579593182,1.606166124,5.839993477,1.140767455,3.199543715,1.716003895,0.269036293,3.166656971,6.331548691,7.189392090,8.279562950,5.191657543,5.184164047,3.265493870,9.542333603,0.275278568,3.074613571,7.878507614,7.565058708,2.096576452,4.372281075,9.742077827,8.896146774,5.764885902,4.998623848,0.990428686,7.717903137,6.106318951,2.216285706,1.972075462,0.913257122,9.684223175,7.404320717,4.805112362,7.006101608,8.301190376,7.656093597,8.272910118,6.742639542,7.913933277,1.611484170,2.563485146,5.875254631,8.927736282,8.997898102,7.332720757,8.315142632,9.691764832,6.168895245,1.253062248,5.823696136,4.745742321,3.574514151,2.941217661,3.210890770,5.147173882,1.172188640,2.147252083,1.094737649,9.062665939,1.073951840,4.298012733,3.605961800,8.173375130,2.572335005,5.550523758,6.877877235,4.155619621,3.595096827,1.932553053,6.517544270,8.941416740,7.587022781,7.904479504,6.337442875,2.409890652,8.840207100,7.342851162,4.273126602,1.924570084,6.348209381,8.367419243,0.628453553,7.640852928,8.031831741,2.780594349,7.980880737,8.920609474,8.562038422,0.650405884,9.876132965,1.395323277,6.858448029,8.564099312,3.947848320,3.584004402,0.039737932,7.785326958,3.410262823,4.585616589,5.797928810,6.283641815,0.897734404,5.491412163,8.542281151,3.293959618,6.540518284,0.216851294,8.305290222,4.217378139,6.633517265,3.697669029,4.469390869,2.631377220,8.629500389,1.935294151,2.818253279,4.747833252,9.492307663,1.816862106,4.648154259,2.404248714,2.716167212,7.566049576,0.353703529,5.072397709,1.176159620,9.800265312,6.735271454,7.004088879,3.772729397,4.316574097,1.048788548,4.919252872,0.284967750,3.777417183,0.330240190,7.313984871,0.949575245,1.497779012,0.396007121,9.275220871,2.410571814,5.427913189,1.648845911,4.248957157,5.492430210,6.559634686,3.154018164,4.883713245,8.726154327,4.514055729,8.442534447,1.065985918,5.903378010,1.577154517,6.372430801,5.635962486,5.422654629, };
F32 e1_input_x1[E1_INPUT_COUNT] = { 6.170094013,5.121863365,8.799041748,9.221541405,0.228291929,9.942363739,4.897036076,4.653863430,7.909969807,4.412671089,1.729972959,4.777218342,2.733619690,6.132029533,1.540628910,2.654185295,8.581409454,5.468779087,0.759369791,5.315045357,3.407706976,2.270687580,9.145686150,4.058911324,4.234752178,4.221756935,1.013485074,2.513605356,7.167196751,0.381406844,8.300293922,2.428095818,6.818869114,0.869159043,8.981331825,0.630703926,7.459387302,2.603268147,6.518499374,7.966778278,6.372343063,6.229414463,8.900707245,9.614938736,8.262906075,7.824367523,0.910948157,0.897597730,2.280363798,8.353528023,0.895073950,3.221147537,7.661661625,6.692000389,1.428988576,4.568064690,6.212133408,1.594235659,9.276584625,5.633558750,4.505672932,6.108387947,2.705281019,2.688159466,1.007776380,1.933597088,0.898046017,8.399520874,8.557020187,3.591453552,2.562575102,9.887388229,4.960102558,5.837659359,2.228970766,0.103144504,9.539550781,2.454233885,2.868043900,8.817598343,6.879308701,4.405155659,9.737854004,4.830202579,0.087071426,5.006950378,3.470536232,1.334539175,5.241065502,0.030169118,5.439417839,4.392495632,5.542574406,2.518674374,6.712769508,6.782931328,4.838000298,3.472854137,2.573790789,6.218910694,3.260834694,7.644095421,3.863369942,7.525837421,5.057912350,7.669823170,2.871217728,9.135972023,9.380666733,8.950455666,7.647608757,7.200494766,0.926031590,3.599883080,7.141575336,3.874069214,2.036708117,1.482990026,9.362141609,9.779808998,3.812220097,8.737421989,4.121242046,1.378913641,2.742804527,3.229137659,8.154693604,3.861438990,0.794235408,6.825776100,0.023114122,7.327494621,1.265963316,3.821471214,8.948528290,8.977483749,7.446332455,2.049180031,2.874994040,7.162597656,2.987554073,5.382235050,5.204577446,2.989520550,9.886218071,6.065805435,5.659677982,6.487961769,6.302479744,8.934953690,0.308369219,8.334625244,9.273800850,9.279170990,0.901084304,4.906507969,6.967551708,5.401965141,7.370896339,4.016580582,3.229212284,1.916414499,7.711717606,7.292090416,5.813984871,2.365413904,8.082777023,2.824721575,5.648893356,8.022757530,4.485117912,5.095584393,3.243449211,0.078679800,1.130167961,9.542452812,3.009232521,6.964795589,1.086915493,6.140971661,4.847644329,0.221689522,8.456147194,6.938362598,8.380078316,2.872364759,9.236854553,0.587059438,7.444991589,0.412715048,8.219246864,4.204732418,0.085975267,5.420126915,9.434914589,4.214818954,1.251260638,8.991718292,0.470038921,0.097555161,4.084986210,3.208123446,5.995990753,9.155587196,5.911703110,5.672768593,6.090679169,8.936711311,4.539833546,8.166711807,9.577285767,6.170354366,8.692478180,2.715023756,5.931256294,9.442282677,5.717384815,7.904523849,8.066604614,4.093060493,2.293819666,7.142215252,7.864789009,1.311270118,6.932307243,7.819821358,9.841536522,4.068682194,3.539235353,5.662454605,9.138729095,1.044457078,1.465112925,8.772166252,2.379247189,2.321868896,1.422588348,8.948627472,7.841458321,6.550879478,1.310026526,5.327462196,0.584015608,7.674731255,4.216899395,8.772316933,1.100435019,2.629443645,4.671567440,0.333913982,1.402368665,8.049636841,4.115736961,3.828215361,6.351834297,5.722761631, };
F32 e1_input_y1[E1_INPUT_COUNT] = { 9.168631554,3.032736778,9.214295387,0.337305397,5.914016724,0.249744922,0.406018525,9.343505859,4.578986645,7.327013493,9.574023247,6.588691711,8.532162666,3.783134460,7.680947781,1.418042302,8.399696350,3.314030409,8.098731995,8.039483070,7.450331688,6.418247700,0.320808053,1.978659868,6.119854450,6.221366405,7.636293888,8.410109520,5.290636539,8.870138168,7.238851070,2.757189274,6.901740074,0.151438266,2.241051435,1.784157038,4.639087677,3.750419855,0.404709339,2.048702717,5.938288689,7.122314453,1.483227134,0.736500323,7.905251503,0.727515578,3.697535753,1.203185558,8.675138474,8.339139938,0.312030345,8.619974136,8.522268295,2.995275497,4.573642731,3.259105682,9.971556664,2.276487827,1.736704111,7.687809944,8.713171959,7.333531380,4.568071842,3.462595701,5.722342491,7.919307709,1.319535255,3.932655096,3.996861458,1.746698856,6.749392509,5.450716496,8.474226952,6.922016621,8.395349503,8.146683693,1.585502148,7.173781872,3.794449568,0.898666680,2.185948610,8.635210037,8.158487320,2.196317673,1.877899885,4.825960636,4.431041718,5.670684814,0.980448186,5.873029232,4.372774601,6.050249100,1.209046125,5.767187119,6.916685104,6.093343735,0.754061222,9.381695747,6.434469700,6.371357918,8.185823441,4.549147129,8.336003304,5.341115952,5.409690857,9.318845749,5.929842949,2.742676973,6.091562271,0.278141320,1.977878213,9.356803894,5.465001583,4.004769802,2.734526634,0.742093921,3.440227509,6.556635380,0.447611451,9.889164925,0.265576065,0.058736451,5.347321033,3.676746845,3.079653978,5.993322372,2.680033684,3.684978724,6.826408386,6.856132507,3.170449495,5.321710587,1.666480064,7.219618797,2.092432499,3.161057949,0.769696355,2.839876175,5.754933834,7.204703808,4.164024353,7.987277985,3.381922245,6.221611500,0.573202312,2.775913239,7.674610138,2.955215454,5.358705521,1.093321085,2.787110567,7.330428123,2.677491903,2.099096060,4.732396126,2.412090778,6.085019588,5.358347416,9.733901978,2.238523483,1.208991170,5.005035877,5.440364361,4.589103699,8.335559845,5.365906715,6.480032921,6.473275185,6.482965946,4.641689777,0.025933122,8.694409370,8.026145935,3.004638195,0.729034603,3.353438854,1.297271132,6.931704998,9.202989578,5.756213665,9.100111961,5.441884518,6.598338604,3.360758305,9.040391922,7.563646317,7.264201164,4.114349842,3.860175848,0.305771112,2.023947477,6.906770706,5.106356621,4.191767693,7.889429092,3.103263617,4.786323071,0.351191461,7.799451828,5.340225697,2.327888966,2.378971815,7.966495037,7.205263138,0.181792215,6.302698135,6.033723354,6.562493324,4.111172199,0.800052762,7.130544186,4.883839607,1.266121626,4.552046776,1.090928793,1.211169243,8.230456352,1.920685053,1.278864264,7.228000641,5.389646530,6.648364067,1.794911146,0.268361270,5.945091724,3.615236759,7.717222691,1.229416013,7.583358288,9.031807899,9.297115326,0.551473916,0.315064192,8.508296967,7.342517376,0.343215704,5.616347790,9.896614075,9.995755196,4.424749851,6.600381851,8.447628975,6.453897953,5.049096107,7.352740288,6.781353474,3.312015533,3.457890511,0.076112077,2.221678495,5.388772011,6.535958290,7.579507828,3.881346941,0.602734149,3.741858959, };
F32 e1_input_z1[E1_INPUT_COUNT] = { 5.421283245,6.291838169,2.936908007,5.237504005,1.270471096,7.540442944,0.328083664,2.060791492,4.422531128,1.955723882,5.077413559,9.433874130,0.412377656,5.980195999,8.840328217,8.923413277,8.741830826,7.344125748,6.229611397,4.847661018,9.454895020,2.895093918,9.087858200,9.464181900,0.472252637,6.098390102,2.680052280,7.577557564,4.798948288,3.876804829,3.964494705,8.423763275,4.932624340,3.943130493,3.816228151,6.364629745,4.537919044,1.964848042,1.408539891,2.478984118,0.013754860,0.426138788,3.916509628,4.662561893,8.684630394,7.324349403,7.580169678,6.141359329,1.920896888,2.002943754,8.321891785,6.909775257,1.573791981,9.666326523,2.169852495,6.036264420,4.729464054,6.284265041,8.231382370,0.139625773,3.201278687,5.803520203,5.987864017,2.191899776,7.975849152,3.027028799,9.243015289,1.549158096,0.384879351,7.718541145,9.800954819,8.614448547,7.593041420,3.645905972,2.933819771,4.356914043,2.695348501,1.461982131,1.113971591,4.215887547,9.687258720,8.622387886,5.718715668,1.975190043,8.400068283,0.322150469,1.938218474,8.698368073,2.858430862,8.537723541,9.185268402,3.283950090,2.140675545,6.729201794,5.439279556,7.984814167,7.998047829,7.596539497,0.270731807,2.541804314,9.685457230,7.351262569,0.093091175,1.706338644,7.354090691,7.498174667,3.986905813,6.130462646,8.585771561,9.023328781,7.517968178,7.680374146,5.578579426,8.276139259,3.775267601,8.042155266,8.822529793,5.492181301,7.812328815,1.288257360,8.422027588,6.092821121,6.275810719,9.088614464,8.659809113,4.551821232,6.608252525,2.598966360,4.708797932,7.347047806,2.808365822,1.783593655,0.809735894,3.694960117,1.337914586,5.832175732,8.937045097,9.666030884,8.580342293,1.314016342,7.373073578,9.605237961,8.627431870,5.222167969,7.690660954,3.316150665,9.530497551,0.715297997,9.300519943,3.220916748,0.362103105,4.934144497,7.725506783,3.096072197,8.726776123,1.526108742,7.559518337,6.005421162,1.275395632,9.340353966,1.115924239,9.222308159,9.403703690,8.297465324,5.579152107,2.302381039,2.246718884,6.375012875,6.046727180,2.498968124,8.924606323,2.671215296,1.141474128,9.221336365,9.613866806,4.799861908,1.757238626,2.369824171,8.051161766,0.748584986,6.322975159,8.770064354,4.495280266,8.387115479,8.320789337,9.940656662,9.334428787,5.582430363,4.512373447,9.839769363,6.785485268,4.546063423,2.714046001,5.475759029,0.852326274,6.018711090,4.112030029,2.055536032,3.981258392,4.746924400,9.989862442,0.236668661,3.408208132,0.539581776,0.556981325,2.244033098,6.471717358,9.302606583,1.624621391,3.003558874,6.568698406,3.722798347,9.849740028,0.086978756,0.090049922,1.608130336,1.928195715,6.525245190,7.880365849,0.840629458,0.131985784,9.706010818,9.470344543,3.126466513,7.827725887,4.182721615,0.136332750,5.389879227,9.911141396,4.261617661,7.697602272,8.843019485,3.686728716,6.194853783,4.152462482,0.685355961,4.399208069,5.487161160,9.240847588,8.333662033,8.336961746,1.991408348,7.422354221,7.849059582,8.856534004,6.947575092,5.236496449,1.105892062,1.710021496,2.988631487,7.974574566,8.511844635,6.792223454,7.851753235,8.456980705,3.286372185, };

F32 e1_output_x[E1_INPUT_COUNT] = { -4.260919189e+01,2.080852890e+01,-3.802598000e+00,2.698244476e+01,-4.624528503e+01,1.377175331e+01,-3.337292075e-01,-5.254003525e+01,-1.024321079e+01,-8.027172089e-02,-5.078481674e+01,9.105602264e+00,-3.431405258e+01,1.959314728e+01,-9.320449829e-02,6.284533501e+00,-4.191896820e+01,3.639797211e+00,3.643436050e+01,-6.518708801e+01,5.607546234e+01,-2.818979836e+01,1.873485184e+01,1.122963190e+00,-1.057118702e+01,-1.488222885e+01,4.428795815e+00,3.488414764e+01,-2.813749313e+01,-1.885945320e+00,-6.526738739e+01,8.916699409e+00,-5.542592621e+01,6.718474388e+00,1.540851402e+01,2.651645470e+01,8.332937241e+00,-2.538571358e+00,3.933859348e+00,-3.421284199e+00,-4.914076614e+01,-5.169319916e+01,2.493955612e+01,1.108655357e+01,-2.160134888e+01,4.967903137e+01,5.219449615e+01,4.335577011e+01,-1.186124897e+01,-7.242984009e+01,4.708426285e+01,2.691501617e+00,-2.174691200e+01,7.873698425e+01,-3.872111511e+01,5.589167023e+01,5.585197449e+00,2.393715096e+01,6.534973145e+01,-5.425727463e+01,-1.462898827e+01,1.046264076e+01,2.980818176e+01,-2.057582855e+00,2.774817276e+01,-3.694994736e+01,-4.148991108e+00,-1.918569183e+01,-1.710139465e+01,5.146632004e+01,-1.231025314e+01,1.064932346e+01,-1.741345596e+01,-7.148853302e+00,6.688540459e+00,-3.263452911e+01,-8.032102585e+00,-3.748437881e+01,-1.357205582e+01,1.381929970e+01,4.405461121e+01,-2.658993530e+01,-2.061255455e+01,1.765357018e+00,-3.279852390e+00,-4.396007156e+01,-1.477861023e+01,5.489565277e+01,1.183908939e+01,1.870078659e+01,4.032553101e+01,-3.377558517e+01,1.088155937e+01,7.439708710e+00,-2.853141785e+00,4.659086609e+01,5.382332611e+01,4.132436752e+01,-9.363232613e+00,-1.493500519e+01,3.481660461e+01,1.818569946e+01,-1.411068153e+01,4.616816521e+00,4.463920593e+01,-2.217312241e+01,-9.582988739e+00,3.006440926e+01,4.858155823e+01,6.849072266e+01,3.830760193e+01,-3.002521896e+01,2.494870758e+01,2.120031929e+01,-9.280745506e+00,-4.957281113e+00,4.205636024e+00,-1.246179962e+01,2.595837212e+01,-8.058942413e+01,1.940232849e+01,1.470257282e+01,4.057318115e+01,-1.561547470e+01,6.122962189e+01,1.433290863e+01,5.601511955e+00,5.057602406e+00,-5.741749573e+01,-2.201002502e+01,-9.875293732e+00,-2.590021324e+01,-6.262722969e+00,-3.043969917e+01,-1.580857944e+01,3.004966927e+01,5.464087677e+01,6.022312164e+01,6.667173004e+01,-4.068469238e+01,-1.893825531e+00,1.307799530e+01,3.780751038e+01,-4.039250183e+01,4.514036942e+01,-2.495340347e+00,4.427840424e+01,-1.153065205e+01,1.804209709e+01,2.173528433e+00,-7.293433189e+00,1.545706177e+01,-9.753894806e-02,6.379700184e+00,3.454850006e+01,7.266744614e+00,-2.123460007e+01,3.007247925e+01,-2.957415390e+01,2.545030594e+01,-7.986383915e+00,6.022946358e+00,6.365129089e+01,3.038967323e+01,1.351082230e+01,-1.117799759e+00,7.829379082e+00,1.315641785e+01,-5.185902023e+01,-1.702308655e+01,2.992731094e+00,-5.335675812e+01,-1.864392281e+01,5.305439758e+01,3.404763794e+01,2.824003220e+01,3.628652096e-01,-3.373737335e+01,-6.761105347e+01,2.158263445e+00,-6.523753357e+01,-1.861336899e+01,-8.562507629e-01,5.139044571e+01,-3.372172165e+01,-4.933736420e+01,6.167615891e+00,-8.452301025e-01,2.555950928e+01,8.707680511e+01,-1.368579292e+01,-2.628767395e+01,-1.224890137e+01,1.915748787e+01,-5.560959244e+01,3.485184479e+01,1.372538376e+01,3.656116247e+00,-3.649235153e+01,2.722855186e+01,6.619159698e+00,-2.030631638e+01,-1.403817081e+01,-4.577143860e+01,2.364769459e+00,-4.102799606e+01,-1.925047874e+01,-1.175082207e+01,-1.318136024e+01,4.196548462e-02,2.585402870e+01,-2.985519218e+01,3.238740540e+01,-1.234022045e+01,-4.406103134e+00,-9.357290268e+00,-5.392600060e+00,4.177874756e+01,1.113211441e+01,-1.836182022e+01,-3.997843170e+01,4.723035049e+01,-4.939814091e+00,2.603783989e+01,-4.264671326e+00,1.113372040e+01,-5.386216736e+01,7.975253105e+00,3.073291779e+00,3.122673416e+01,-9.169178009e+00,8.197476959e+01,2.730916595e+01,3.830490494e+01,-4.970203400e+01,2.911009789e-01,1.659329605e+01,4.416164017e+01,-7.237639618e+01,5.186160278e+01,3.997658539e+01,3.558910370e+00,7.727336884e-01,-2.373644447e+01,2.445826340e+01,2.792475891e+01,4.626464844e+00,-2.132307243e+01,1.538783550e+01,1.209278107e-01,2.631869888e+01,-1.817539215e+01,1.756178284e+01,2.515068245e+01,5.588350677e+01,5.923395157e+00, };
F32 e1_output_y[E1_INPUT_COUNT] = { 8.355686188e+00,-6.441688538e-02,9.467729568e+00,1.951937294e+01,2.361524105e-02,1.484453583e+01,1.084975338e+01,2.366783142e+01,1.375663185e+01,-6.189166069e+00,-2.248930740e+01,-5.525362396e+01,1.202373123e+01,4.041615295e+01,-3.427519989e+01,5.024568558e+00,1.205173111e+01,-2.297663498e+01,-1.969840431e+01,1.940555954e+01,-1.514612770e+01,-3.037929535e-01,6.808814240e+01,-1.262071419e+01,7.288858414e+00,-1.559210587e+01,-1.117294312e+01,-8.373590469e+00,3.483059692e+01,-3.012667084e+01,7.504003906e+01,-2.807369995e+01,5.688709641e+01,-1.626414680e+01,3.985429382e+01,-4.688115311e+01,-6.797985077e+00,-2.917233467e+00,3.421083832e+01,1.348013783e+01,5.263906097e+01,4.342296219e+01,1.631211853e+01,4.875782013e+01,-2.442770004e+01,-5.893277740e+01,-3.843923187e+01,-3.388500977e+01,-4.967750549e+00,6.237563705e+01,2.014159203e+00,-6.453510284e+01,2.200026321e+01,-3.585282135e+01,4.563409805e+00,-4.089106369e+01,-1.585216713e+01,-5.666329575e+01,6.822980499e+01,3.915208054e+01,-1.236020756e+01,-4.318835068e+01,-2.256641769e+01,9.553022385e+00,-1.075988865e+01,-6.768297195e+00,-1.179080391e+01,6.327091980e+01,3.558549118e+01,4.087295532e+00,-3.431828308e+01,-4.572383881e+00,8.753485680e+00,1.718439484e+01,-1.426139164e+01,-2.339038849e+01,6.062964630e+01,1.186014271e+01,7.639843941e+00,2.683848572e+01,2.656642723e+01,3.008778381e+01,1.052922058e+01,2.934871674e+01,-5.630915451e+01,4.569104004e+01,-7.171249390e-01,-2.061176109e+01,2.601746941e+01,-6.412176514e+01,-4.064072037e+01,3.039100266e+01,1.511832905e+01,-1.809651947e+01,-2.527851677e+01,-2.393777084e+01,-2.172350693e+01,-4.950149536e+01,2.465264797e+00,2.830394936e+01,-2.035410309e+01,2.390645981e+01,6.343523979e+00,-1.036499596e+01,-5.189816666e+01,-3.893871307e+00,-1.399097633e+01,4.260608673e+01,-3.624308014e+01,-3.073324203e+01,-7.417528152e+00,5.792257309e+01,-4.264759445e+01,-8.879990578e+00,3.253171921e+01,-2.983008385e+01,-5.061666489e+01,-1.786939144e+00,6.635371399e+01,8.515534973e+01,1.112258244e+01,6.008953094e+00,3.772301912e+00,-7.289933777e+01,1.235167980e+01,-2.695389175e+01,-4.834539032e+01,2.481118202e+00,-3.634016418e+01,3.659521484e+01,-1.410675907e+01,4.559428787e+01,6.446516037e+00,2.101553154e+01,7.364180756e+01,1.651391220e+01,6.732925415e+00,-7.761752319e+01,-5.747031403e+01,3.685506439e+01,-3.188784218e+01,-3.298176575e+01,-1.250458908e+01,9.584858894e+00,9.209449005e+01,9.024324417e+00,-2.309654617e+01,3.748361206e+01,-3.832787323e+01,2.096921921e+01,-2.461890459e+00,-6.439859390e+00,2.353500366e+00,-1.304034138e+01,-1.815556335e+01,-5.560278893e+00,-9.222663879e+00,-2.059346199e+00,2.299884033e+01,1.007218552e+01,1.766389084e+01,-2.823651505e+01,1.381980896e+00,3.916267776e+01,-1.344167709e+00,6.343981266e+00,1.338066673e+01,-2.701655579e+01,-7.274410248e+00,5.142361069e+01,2.566165924e+01,1.926164627e+01,-2.158576488e+00,-6.514012909e+01,-8.246911621e+01,2.302879715e+01,4.041264534e+00,3.248380661e+01,-6.130849075e+01,2.328266621e+00,-1.454565811e+01,-9.978824615e+00,1.811669350e+01,5.108335114e+01,4.222244644e+01,-5.370519257e+01,-3.302393341e+01,4.028828144e+00,-2.758668709e+01,-6.945748138e+01,3.668655396e+00,-2.749919891e-01,-5.461187363e+00,-1.001587772e+01,7.219176483e+01,2.219023705e+00,-9.350658417e+00,4.557006073e+01,-1.322569466e+01,-1.087930870e+01,-4.130947876e+01,2.696912766e+01,1.529652405e+01,5.492620087e+01,-2.169490814e+00,4.190172195e+01,-1.037293053e+01,4.416177750e+01,1.155236626e+01,2.978158951e+01,-9.764537811e-01,3.016359138e+01,-6.505177307e+01,7.606360435e+00,2.778259277e+01,7.821458435e+01,1.021522045e+01,-2.287549973e+01,-4.316690063e+01,4.791040897e+00,1.690386009e+01,-2.647724342e+01,-8.519470215e+00,-1.621288490e+01,3.866210175e+01,1.740425110e+01,6.856804657e+01,1.223779678e+00,-7.301570129e+01,-1.111956596e+01,-2.025223541e+01,-1.769054413e+01,-3.657453537e+00,-5.725956726e+01,1.262837219e+01,-1.252620697e+00,4.319548607e-02,-1.344497490e+01,6.858917236e+01,-5.954392242e+01,1.629214287e+00,2.014652729e+00,-6.301259995e-01,1.641888237e+01,3.947948456e+00,2.345677376e+01,-1.599594307e+01,2.143446350e+01,4.001749039e+00,-1.787277031e+01,-3.916193008e+01,-9.248069763e+00,-4.956949234e+01,1.205251694e+00,1.108942032e+01,-1.822267532e+00, };
F32 e1_output_z[E1_INPUT_COUNT] = { 3.436317825e+01,-1.690810966e+01,-1.831151772e+01,-4.876439667e+01,8.199921608e+00,-1.865024567e+01,-8.445762634e+00,1.134206581e+01,4.077317238e+00,2.336849213e+01,5.970944214e+01,3.397857285e+01,-2.130779457e+01,-4.565828323e+01,2.979636002e+01,-2.667742014e+00,2.956966209e+01,7.657825470e+00,2.116744232e+01,3.928939056e+01,-8.275615692e+00,2.278338814e+01,-2.125762749e+01,2.156984329e+00,3.379554749e-01,2.620910645e+01,3.016036606e+01,-2.278064728e+00,3.623899460e+00,6.911543274e+01,-3.695802689e-01,6.618645668e+00,-2.975661278e+00,-8.562762141e-01,-5.966742325e+01,1.051425076e+01,-6.748060226e+00,8.931699753e+00,-2.803492165e+01,-1.452951431e-01,4.041590500e+01,2.991128922e+01,-6.285552216e+01,-3.056402779e+01,4.278789520e+01,-4.721681976e+01,1.247781467e+01,3.018732071e-01,3.651622009e+01,4.238037109e+01,-5.139742374e+00,7.925309753e+01,-1.326393890e+01,-4.340003586e+01,1.588155174e+01,-2.021920395e+01,2.608642960e+01,1.445385265e+01,-8.804320526e+01,3.343082428e+01,5.423146820e+01,4.356205368e+01,3.748500824e+00,-1.256770325e+01,4.213697910e+00,4.130998993e+01,2.086371660e+00,-5.659336853e+01,1.067008400e+01,-2.487233925e+01,2.685182571e+01,-9.329814911e+00,1.605877876e+00,-2.117939758e+01,3.572843933e+01,4.450860596e+01,-7.236831665e+00,4.728754997e+00,8.919661522e+00,-3.462423706e+01,-3.727970123e+01,-1.654779816e+01,2.007785034e+01,-3.695145416e+01,1.262234211e+01,-1.233117580e+00,2.810174370e+01,5.015009880e+00,-3.063156700e+01,4.404275131e+01,-4.532768250e+00,-1.081442547e+01,-3.671299362e+01,1.272480774e+01,3.566575623e+01,-2.131064987e+01,-3.050949478e+01,4.224218750e+01,3.042246628e+01,-3.440670776e+01,5.480782509e+00,-3.370403290e+01,1.756501770e+01,1.208156204e+01,7.475002289e+00,2.752007294e+01,2.771049690e+01,-6.386505127e+01,-2.736509323e+01,-6.699024963e+01,-3.701672363e+01,-4.241638565e+01,3.763787460e+01,-4.924561501e+00,-6.007442474e+00,5.140608788e+00,1.876640892e+01,5.498185635e+00,-3.490977478e+01,-4.189080048e+01,-9.133172989e+00,-2.114218140e+01,-2.985807037e+01,3.186017036e+01,-2.378572083e+01,2.532182884e+01,1.269453049e+01,-1.103226757e+01,6.236746979e+01,-1.370157528e+01,1.600682640e+01,-2.963451004e+01,-3.475963593e+00,-9.580533981e+00,-9.437814713e+00,-5.520613098e+01,-4.610656357e+01,1.003681374e+01,1.620646095e+01,1.969402885e+01,1.877638245e+01,2.009796143e+01,-1.790597343e+01,1.170413399e+01,-6.489122009e+01,-2.989757538e+00,-7.695770264e+00,-5.027516937e+01,9.857278824e+00,-1.314733315e+01,2.516032219e+01,-1.654225540e+01,-6.985845566e-01,-1.027928352e+01,6.278172493e+00,-1.457461357e+01,2.699553680e+01,-2.521318436e+01,-4.610671997e+00,-1.335816956e+01,3.973606110e+00,1.407264996e+01,-5.299818420e+01,-4.836727905e+01,-1.207124710e+01,-1.363681984e+01,-6.675970459e+01,2.160346413e+01,5.624626541e+01,-4.086500549e+01,-1.578583837e+00,3.908903885e+01,6.815367889e+01,2.077228165e+01,2.251257420e+00,-7.223225403e+01,-3.604838371e+00,4.137763977e+00,7.920706940e+01,-3.560829163e+01,7.095006561e+01,6.662436485e+00,-2.498164749e+01,-6.298284149e+01,-1.191194153e+01,5.511929703e+01,1.959660530e+01,-2.880431652e+00,-1.857134628e+01,-1.493918896e+00,1.548330784e+01,2.473171234e+01,1.066300011e+01,-1.129556274e+01,-5.265594864e+01,-2.555039406e+01,6.707451820e+00,-2.377899551e+01,3.021808052e+01,1.167949581e+01,6.919485092e+00,4.167733669e+00,-1.105769730e+01,4.319396210e+01,-2.439115524e+01,-1.397108555e+01,2.778797150e+01,-1.986514854e+01,7.600178242e+00,-8.046974182e+00,-3.663568497e+01,9.912694931e+00,-2.022016525e+01,-1.288265038e+01,-4.636429596e+01,-3.965418816e+00,-2.761356354e+01,-4.387642670e+01,-4.389867783e+00,4.820958710e+01,4.526945114e+00,-1.661846542e+01,5.717034340e+00,-9.528881073e+00,-2.558670425e+01,-3.585803986e+01,6.833457947e+00,-6.299455643e+00,5.476939011e+01,-1.792516327e+01,3.534633636e+01,-8.578885078e+00,-1.054015160e+01,2.440161514e+01,6.148008347e+00,-3.589073420e-01,-5.420982361e+00,-4.777084351e+01,-1.277632999e+01,-9.152294159e+00,-7.571561813e+00,-1.806711388e+01,4.871068001e-01,1.264741707e+01,-1.492302132e+01,-5.815460968e+01,9.144985199e+00,-1.632185364e+01,-4.221578217e+01,1.327268696e+01,2.183517075e+01,2.428971863e+01,4.467354202e+01,-1.285830402e+01,-4.276310349e+01,-8.239940643e+00, };

static bool e1_scalar_wrapper(bool verify){
  // NOTE: These need to be initialized here to avoid a compiler warning...
  F32 out_x[E1_INPUT_COUNT] = {0};
  F32 out_y[E1_INPUT_COUNT] = {0};
  F32 out_z[E1_INPUT_COUNT] = {0};
  for(U32 i = 0; i < 256; i += 1){
    e1_scalar(e1_input_x0[i], e1_input_y0[i], e1_input_z0[i],
              e1_input_x1[i], e1_input_y1[i], e1_input_z1[i],
              out_x[i], out_y[i], out_z[i]);
  }

  if(!verify) return true;
  return memcmp(out_x, e1_output_x, sizeof(out_x)) == 0
      && memcmp(out_y, e1_output_y, sizeof(out_x)) == 0
      && memcmp(out_z, e1_output_z, sizeof(out_x)) == 0;
}

static bool e1_vector_wrapper(bool verify){
  // NOTE: These need to be initialized here to avoid a compiler warning...
  F32 out_x[E1_INPUT_COUNT] = {0};
  F32 out_y[E1_INPUT_COUNT] = {0};
  F32 out_z[E1_INPUT_COUNT] = {0};
  for(U32 i = 0; i < 256; i += 4){
    __m128 x0 = _mm_loadu_ps(e1_input_x0 + i);
    __m128 y0 = _mm_loadu_ps(e1_input_y0 + i);
    __m128 z0 = _mm_loadu_ps(e1_input_z0 + i);

    __m128 x1 = _mm_loadu_ps(e1_input_x1 + i);
    __m128 y1 = _mm_loadu_ps(e1_input_y1 + i);
    __m128 z1 = _mm_loadu_ps(e1_input_z1 + i);

    __m128 x;
    __m128 y;
    __m128 z;

    e1_vector(x0, y0, z0,
              x1, y1, z1,
              x, y, z);

    _mm_storeu_ps(out_x + i, x);
    _mm_storeu_ps(out_y + i, y);
    _mm_storeu_ps(out_z + i, z);
  }

  if(!verify) return true;
  return memcmp(out_x, e1_output_x, sizeof(out_x)) == 0
      && memcmp(out_y, e1_output_y, sizeof(out_x)) == 0
      && memcmp(out_z, e1_output_z, sizeof(out_x)) == 0;
}

//
// EXERCISE 2 WRAPPER
//

#define E2_INPUT_COUNT 8183
static F32 e2_input[E2_INPUT_COUNT];
static F32 e2_output = -9.992634766e+03;

static bool e2_wrapper(bool verify){
  F32 out = e2(e2_input, E2_INPUT_COUNT);
  if(!verify) return true;
  return out == e2_output;
}

//
// EXERCISE 3 WRAPPER
//

#define E3_INPUT_COUNT 8192
static int e3_input[E3_INPUT_COUNT];
static int e3_output[E3_INPUT_COUNT];
static int e3_output_buffer[E3_INPUT_COUNT];

static bool e3_wrapper(bool verify){
  e3(e3_input, e3_output_buffer, E3_INPUT_COUNT);
  if(!verify) return true;
  fiz(E3_INPUT_COUNT){
    if(e3_output_buffer[i] != e3_output[i]){
      printf("E3: diff at location %i: %i vs %i\n", (int)i, e3_output_buffer[i], e3_output[i]);
      return false;
    }
  }
  return true;
}

//
// EXERCISE 4 WRAPPER
//

#define E4_INPUT_COUNT 8192

static int e4_input[E4_INPUT_COUNT];
static int e4_output[E4_INPUT_COUNT];
static int e4_output_buffer[E4_INPUT_COUNT];

static bool e4_wrapper(bool verify){
  e4(e4_input, e4_output_buffer, E4_INPUT_COUNT);
  if(!verify) return true;
  return memcmp(e4_output_buffer, e4_output, E4_INPUT_COUNT * sizeof(int)) == 0;
}

//
// PROFILING STUFF
//

// NOTE(hanna): Our very naive microbenchmarking routine
static void profile(const char *name, int N, bool (*proc)(bool verify)){
  if(!proc(true)){
    printf("%30s: FAIL!\n", name);
    return;
  }
  U64 start_us = os_get_monotonic_time_us();
  fiz(N){
    proc(false);
  }
  U64 end_us = os_get_monotonic_time_us();

  printf("%30s: %.3fus\n", name, (end_us - start_us) / (double)N);
}

int main(int argc, char **argv){
  ThreadContext _tc = {0};
  set_thread_context(&_tc);

  Allocator *temp = temp_begin();

#if 0
  {
    PCG_State rng = pcg_create_with_os_entropy();

    fiz(1){
      fiz(8192){
        printf("%.9e,", pcg_random_f32(&rng, -10000, 10000));
      }
      printf("\n");
      fflush(stdout);
    }
  }
  return 0;
#elif 0
  {
    PCG_State rng = pcg_create_with_os_entropy();

    Array(F32) out = array_create(F32, temp);
    F32 min = F32_INFINITY;
    fiz(E2_INPUT_COUNT){
      F32 value = pcg_random_f32(&rng, -10000, 10000);
      if(value < min){
        min = value;
      }
      array_push(&out, value);
    }
    printf("%.9e\n", min);

    OSFile file = os_open_file_output(LIT_STR("e2.bin"));
    os_write_to_file(file, 0, (U8*)out.e, out.count * sizeof(F32), NULL);
    os_close_file(file);
  }
  return 0;
#elif 0
  {
    PCG_State rng = pcg_create_with_os_entropy();

    Array(I32) input = array_create(I32, temp);
    Array(I32) output = array_create(I32, temp);
    I32 sum = 0;
    fiz(E3_INPUT_COUNT){
      I32 value = pcg_random_u32_range(&rng, 0, 100);
      sum += value;

      array_push(&input, value);
      array_push(&output, sum);
    }

    {
      OSFile file = os_open_file_output(LIT_STR("e3_input.bin"));
      os_write_to_file(file, 0, (U8*)input.e, input.count * sizeof(I32), NULL);
      os_close_file(file);
    }

    {
      OSFile file = os_open_file_output(LIT_STR("e3_output.bin"));
      os_write_to_file(file, 0, (U8*)output.e, output.count * sizeof(I32), NULL);
      os_close_file(file);
    }
  }
  return 0;
#elif 0
  {
    PCG_State rng = pcg_create_with_os_entropy();

    Array(I32) input = array_create(I32, temp);
    Array(I32) output = array_create(I32, temp);
    for(int j = 0; j < E3_INPUT_COUNT; j += 4){

      for(int i = 0; i < 4; i += 1){
        I32 value = pcg_random_u32_range(&rng, 1, 1000000000);

        array_push(&input, value);
        array_push(&output, value);
      }

      std::sort(output.e + j, output.e + j + 4, [](int a, int b){ return a < b; });
    }

    {
      OSFile file = os_open_file_output(LIT_STR("e4_input.bin"));
      os_write_to_file(file, 0, (U8*)input.e, input.count * sizeof(I32), NULL);
      os_close_file(file);
    }

    {
      OSFile file = os_open_file_output(LIT_STR("e4_output.bin"));
      os_write_to_file(file, 0, (U8*)output.e, output.count * sizeof(I32), NULL);
      os_close_file(file);
    }
  }
  return 0;
#endif

  int N = 100000;

  profile("E1 scalar", N, e1_scalar_wrapper);
  profile("E1 vector", N, e1_vector_wrapper);

  {
    EntireFile file = read_entire_file(LIT_STR("e2.bin"), temp);
    memcpy(e2_input, file.data, sizeof(F32) * E2_INPUT_COUNT);
    profile("E2", N, e2_wrapper);
  }

  {
    {
      EntireFile file = read_entire_file(LIT_STR("e3_input.bin"), temp);
      memcpy(e3_input, file.data, sizeof(I32) * E3_INPUT_COUNT);
    }
    {
      EntireFile file = read_entire_file(LIT_STR("e3_output.bin"), temp);
      memcpy(e3_output, file.data, sizeof(I32) * E3_INPUT_COUNT);
    }
    profile("E3", N, e3_wrapper);
  }

  {
    {
      EntireFile file = read_entire_file(LIT_STR("e4_input.bin"), temp);
      memcpy(e4_input, file.data, sizeof(I32) * E4_INPUT_COUNT);
    }
    {
      EntireFile file = read_entire_file(LIT_STR("e4_output.bin"), temp);
      memcpy(e4_output, file.data, sizeof(I32) * E4_INPUT_COUNT);
    }
    profile("E4", N, e4_wrapper);
  }

  temp_end(&temp);

  return 0;
}
